(function(e,i){typeof exports=="object"&&typeof module<"u"?module.exports=i():typeof define=="function"&&define.amd?define(i):(e=typeof globalThis<"u"?globalThis:e||self,e.EhTilt3d=i())})(this,function(){"use strict";class e{constructor(t){this.container=t.container,this.maxRotation=t.maxRotation,this.speedFactor=t.speedFactor,this.direction=t.direction,this.animateOnContainer=t.animateOnContainer,this.mouse=window.ElementsHiveUtils.mouse,this.currentRotation={x:0,y:0},this.targetRotation={x:0,y:0},this.shouldRender=!this.animateOnContainer,this.isTransformSet=!1,this.lerpFactor=.08,this.mouseEnterLeaveHandler=this.toggleShouldRender.bind(this),this.mouseMoveHandler=this.onMouseMove.bind(this),this.updateBoundsHandler=this.updateBounds.bind(this),this.renderHandler=this.render.bind(this),this.init()}init(){this.updateBounds(),this.initEvents(),requestAnimationFrame(this.renderHandler)}updateBounds(){this.bounds=this.container.getBoundingClientRect()}toggleShouldRender(){this.shouldRender=!this.shouldRender}setTransitionEasing(){clearTimeout(this.transitionTimeout),this.container.style.transition="transform .4s ease-in-out",this.transitionTimeout=setTimeout(()=>{this.container.style.transition=""},400)}onMouseMove(){if(!this.shouldRender){this.targetRotation.x=0,this.targetRotation.y=0;return}let t=0,n=0;this.animateOnContainer?(t=this.mouse.currentPosition.x-this.bounds.left-this.bounds.width/2,n=this.mouse.currentPosition.y-this.bounds.top-this.bounds.height/2,this.targetRotation.x=t/(this.bounds.width/2)*this.maxRotation,this.targetRotation.y=n/(this.bounds.height/2)*this.maxRotation):(this.targetRotation.x=this.mouse.normalizedCurrentPosition.x*this.maxRotation,this.targetRotation.y=this.mouse.normalizedCurrentPosition.y*this.maxRotation)}render(){if(this.isDestroyed||(requestAnimationFrame(this.renderHandler),Math.round(this.targetRotation.x)===Math.round(this.currentRotation.x)&&Math.round(this.targetRotation.y)===Math.round(this.currentRotation.y)))return;this.currentRotation.x=window.ElementsHiveUtils.math.lerp(this.currentRotation.x,this.targetRotation.x,this.lerpFactor*this.speedFactor),this.currentRotation.y=window.ElementsHiveUtils.math.lerp(this.currentRotation.y,this.targetRotation.y,this.lerpFactor*this.speedFactor);const t=this.direction*this.currentRotation.x.toFixed(2),n=this.direction*this.animateOnContainer?-this.currentRotation.y.toFixed(2):this.currentRotation.y.toFixed(2);this.container.style.setProperty("--eh-rotation-x",n+"deg"),this.container.style.setProperty("--eh-rotation-y",t+"deg"),this.container.style.transform="perspective(100vw) translate3d(var(--eh-position-x), var(--eh-position-y),0) rotateY(var(--eh-rotation-y)) rotateX(var(--eh-rotation-x))"}initEvents(){this.isDestroyed=!1,this.animateOnContainer&&(this.container.addEventListener("mouseenter",this.mouseEnterLeaveHandler),this.container.addEventListener("mouseleave",this.mouseEnterLeaveHandler)),this.mouse.on("move",this.mouseMoveHandler),window.addEventListener("resize",this.updateBoundsHandler),document.addEventListener("scroll",this.updateBoundsHandler)}deleteEvents(){this.container.removeEventListener("mouseenter",this.mouseEnterLeaveHandler),this.container.removeEventListener("mouseleave",this.mouseEnterLeaveHandler),window.removeEventListener("resize",this.updateBoundsHandler),document.removeEventListener("scroll",this.updateBoundsHandler)}resetStyles(){this.container.style.transform=`
            perspective(0)
			translate3d(var(--eh-position-x), var(--eh-position-y),0)
            rotateY(0deg)
            rotateX(0deg)
        `}resetState(){this.currentRotation={x:0,y:0},this.targetRotation={x:0,y:0},this.shouldRender=!this.animateOnContainer,this.deleteEvents(),this.updateBounds()}destroy(){this.isDestroyed=!0,this.deleteEvents()}}return e});
