(function(r,i){typeof exports=="object"&&typeof module<"u"?module.exports=i():typeof define=="function"&&define.amd?define(i):(r=typeof globalThis<"u"?globalThis:r||self,r.EhMorphingCursor=i())})(this,function(){"use strict";function r(o,e,t){return(1-t)*o+t*e}class i{constructor(e){this.options=e,this.cursorWrapper=e.cursorWrapper,this.cursorInner=e.cursorInner,this.cursorHalfSize=e.cursorSize/2,this.morphTargets=e.morphTargets,this.styleAttribute=e.styleAttribute,this.disableSqueeze=e.disableSqueeze,this.speedFactor=e.speedFactor,this.mouse={x:0,y:0},this.targetMouse={x:0,y:0},this.positionDifference={x:0,y:0},this.squeezeLimit=.5,this.distanceDivider=1500,this.lerpFactor=.1*e.speedFactor,this.initEvents(),requestAnimationFrame(this.render.bind(this))}getDifferenceAngle(){return Math.atan2(this.positionDifference.x,this.positionDifference.y)*180/Math.PI}getSqueezeRatio(){const e=Math.sqrt(Math.pow(this.positionDifference.x+this.positionDifference.y,2));return Math.min(e/this.distanceDivider,this.squeezeLimit)}onMouseMove(e){this.targetMouse.x=e.clientX,this.targetMouse.y=e.clientY,this.recheckStyle&&this.checkPreviousStyle(e)}checkPreviousStyle(e){this.morphTargets.forEach(t=>{if(e.target.classList.contains(t.selector.slice(1))||e.target.dataset==t.selector){this.cursorWrapper.setAttribute(this.styleAttribute,t.selector),this.recheckStyle=!1;return}if(e.target.classList.contains("section-container")&&(e.target.parentElement.classList.contains(t.selector.slice(1))||e.target.dataset==t.selector)){this.cursorWrapper.setAttribute(this.styleAttribute,t.selector),this.recheckStyle=!1;return}})}initMouseMoveEvent(){window.addEventListener("mousemove",this.onMouseMove.bind(this))}initMorphTargetsEvents(){this.morphTargets.forEach(e=>{const t=document.querySelectorAll(e.selector);t.length!==0&&t.forEach(s=>{s.addEventListener("mouseenter",()=>{this.cursorWrapper.setAttribute(this.styleAttribute,e.selector)}),s.addEventListener("mouseleave",()=>{this.recheckStyle=!0,this.cursorWrapper.setAttribute(this.styleAttribute,"")})})})}initEvents(){this.initMouseMoveEvent(),this.initMorphTargetsEvents()}update(){this.positionDifference.x=Math.round(this.targetMouse.x-this.mouse.x),this.positionDifference.y=Math.round(this.targetMouse.y-this.mouse.y),this.mouse.x=r(this.mouse.x,this.targetMouse.x,this.lerpFactor),this.mouse.y=r(this.mouse.y,this.targetMouse.y,this.lerpFactor);const e=this.mouse.x-this.cursorHalfSize,t=this.mouse.y-this.cursorHalfSize;if(this.cursorWrapper.style.transform=`translate3d(${e}px, ${t}px, 0px)`,!this.disableSqueeze){const s=this.getSqueezeRatio(),a=this.getDifferenceAngle();this.cursorInner.style.transform=`translate(-50%, -50%) rotate(${-a}deg) scale(${1-s}, ${1+s})`}}render(){this.update(),requestAnimationFrame(this.render.bind(this))}}class n{constructor(e){this.options=e,this.domContainer=e.domContainer,this.morphTargets=e.morphTargets,this.wrapperClass=e.wrapperClass,this.innerClass=e.innerClass,this.iconWrapperClass=e.iconWrapperClass,this.iconClass=e.iconClass,this.instanceClass=e.instanceClass,this.init(),this.initCursor()}init(){this.cleanupMarkup(),this.createCursorMarkup(),this.createIconsWrapperMarkup(),this.setupMorphTargets(),this.resetLinksCursorType(),this.initCursor()}initCursor(){const e={cursorWrapper:this.cursorWrapper,cursorInner:this.cursorInner,morphTargets:this.morphTargets,cursorSize:this.options.cursorSize,styleAttribute:this.options.styleAttribute,iconClass:this.iconClass,disableSqueeze:this.options.disableSqueeze,speedFactor:this.options.speedFactor};this.cursor=new i(e)}cleanupMarkup(){var e;(e=document.querySelector(`.${this.wrapperClass}`))==null||e.remove()}createCursorMarkup(){this.cursorWrapper=document.createElement("div"),this.cursorWrapper.classList.add(this.wrapperClass,this.instanceClass),this.cursorWrapper.setAttribute(this.options.styleAttribute,""),this.domContainer.append(this.cursorWrapper),this.cursorInner=document.createElement("div"),this.cursorInner.classList.add(this.innerClass),this.cursorWrapper.append(this.cursorInner)}createIconsWrapperMarkup(){this.iconWrapper=document.createElement("div"),this.iconWrapper.classList.add(this.iconWrapperClass),this.cursorWrapper.append(this.iconWrapper)}createIconMarkup(e){const t=document.createElement("span");t.classList.add(this.iconClass),t.setAttribute("data-eh-for-selector",e.selector),t.innerHTML=e.icon,this.iconWrapper.append(t)}setupMorphTargets(){this.morphTargets.forEach(e=>{e.selector=e.selector.replaceAll('"',"'");const t=document.querySelectorAll(e.selector);t.length!==0&&(t.forEach(s=>{s.style.cursor="none !important"}),this.createIconMarkup(e))})}resetLinksCursorType(){["a","button",'input[type="button"]','input[type="submit"]'].forEach(t=>{document.querySelectorAll(t).forEach(s=>{s.style.cursor="none"})})}}return n});
