(function(a,s){typeof exports=="object"&&typeof module<"u"?module.exports=s():typeof define=="function"&&define.amd?define(s):(a=typeof globalThis<"u"?globalThis:a||self,a.EhContentAccordion=s())})(this,function(){"use strict";var u=Object.defineProperty;var c=(a,s,t)=>s in a?u(a,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[s]=t;var o=(a,s,t)=>(c(a,typeof s!="symbol"?s+"":s,t),t);class a{constructor(t){o(this,"onTrigger",(t,e=!1)=>{if(!e&&!t.target.getAttribute("data-eh-is-trigger"))return;const i=t.target.closest(".eh-content-accordion-item"),n=parseInt(i.dataset.itemIndex);this.isExpanded=i.getAttribute("aria-expanded")=="true",i.setAttribute("aria-expanded",!this.isExpanded),this.activeItem!=null&&this.items[this.activeItem].setAttribute("aria-expanded",!1),this.expand(i,n)});o(this,"onKeyPress",t=>{(t.code==="Space"||t.key==="Enter")&&this.onTrigger(t,!0)});this.container=t.container,this.items=t.items,this.itemsInner=t.itemsInner,this.expandFactor=parseFloat(t.expandFactor),this.transitionType=t.transitionType,this.duration=parseFloat(t.duration),this.itemsTransitionType=t.itemsTransitionType,this.itemsTransitionDuration=t.itemsTransitionDuration,this.itemsShouldStagger=t.itemsTransitionStagger,this.isTouchDevice="ontouchstart"in window,this.activeItem=null,this.init()}init(){this.getItemsChildrens(),this.createEases(),this.initEvents()}getItemsChildrens(){this.itemsChildren&&(this.itemsChildren=null),this.contentItems&&(this.contentItems=null),this.itemsChildren=new Map,this.contentItems=new Map,this.items.forEach((t,e)=>{if(t.setAttribute("data-item-index",e),this.itemsTransitionType=="visibility"){this.itemsChildren.set(e,this.itemsInner[e].children);const i=t.querySelector(".eh-content-accordion-item__default-content");this.contentItems.set(e,i)}})}createEases(){this.eases=new Map,this.eases.set("make_way",{forItem:"back.inOut(1.4)",forItems:"back.in(2)"}),this.eases.set("two_step",{forItem:"back.inOut(1.4)",forItems:"back.out(2)"}),this.eases.set("shaky",{forItem:"elastic.out(1, .6)",forItems:"elastic.out(1, .3)"}),this.eases.set("shaky_2",{forItem:"power4.out",forItems:"elastic.out(1, .6)"}),this.eases.set("mechanic",{forItem:"expo.in",forItems:"expo.out"}),this.eases.set("stretch",{forItem:"elastic.out(1, 1.2)",forItems:"power1.inOut"})}expand(t,e){if(this.isAnimating)return;const i=gsap.timeline({paused:!0,onStart:()=>{this.isAnimating=!0},onComplete:()=>{t.setAttribute("aria-expanded",!this.isExpanded),this.isAnimating=!1,this.activeItem===e&&this.items[this.activeItem].getAttribute("aria-expanded")=="false"?this.activeItem=null:this.activeItem=e,i.kill()}});this.items.forEach((n,r)=>{var h,d;n!==t&&(n===this.items[this.activeItem]&&((h=this.itemsChildren.get(this.activeItem))==null?void 0:h.length)!=0&&i.to(this.itemsChildren.get(this.activeItem),{autoAlpha:0,duration:this.itemsTransitionDuration,ease:"expo.in"},0),n===this.items[this.activeItem]&&((d=this.contentItems.get(this.activeItem))==null?void 0:d.length)!=0&&gsap.to(this.contentItems.get(this.activeItem),{duration:.3,autoAlpha:1,ease:"expo.in",delay:this.duration+this.itemsTransitionDuration}),i.to(n,{flex:this.isExpanded?"1 0 auto":"0.8 0 auto",duration:this.duration,ease:this.eases.get(this.transitionType).forItems},this.itemsTransitionDuration))}),i.to(t,{flex:t.getAttribute("aria-expanded")=="true"?`${this.expandFactor} 0 auto`:"1 0 auto",duration:this.duration,ease:this.eases.get(this.transitionType).forItem,onStart:()=>{var n,r;t.getAttribute("aria-expanded")=="false"&&((n=this.itemsChildren.get(e))==null?void 0:n.length)!=0&&gsap.to(this.itemsChildren.get(e),{autoAlpha:0,duration:this.itemsTransitionDuration,ease:"expo.inOut",stagger:{from:"end",each:this.itemsShouldStagger?this.itemsTransitionDuration/this.itemsChildren.get(e).length:0}},0),((r=this.contentItems.get(e))==null?void 0:r.length)!=0&&i.to(this.contentItems.get(e),{duration:.15,autoAlpha:t.getAttribute("aria-expanded")=="false"?1:0,ease:"expo.inOut",delay:t.getAttribute("aria-expanded")=="false"?this.duration:0},0)},onComplete:()=>{var n;t.getAttribute("aria-expanded")=="true"&&((n=this.itemsChildren.get(e))==null?void 0:n.length)!=0&&gsap.to(this.itemsChildren.get(e),{autoAlpha:1,duration:this.itemsTransitionDuration,ease:"expo.inOut",stagger:this.itemsShouldStagger?this.itemsTransitionDuration/this.itemsChildren.get(e).length:0})}},this.itemsTransitionDuration),i.play()}initEvents(){this.items.forEach((t,e)=>{this.isTouchDevice?t.addEventListener("touchstart",this.onTrigger):(t.addEventListener("click",this.onTrigger),t.addEventListener("keydown",this.onKeyPress))})}removeEvents(){this.items.forEach((t,e)=>{this.isTouchDevice?t.removeEventListener("touchstart",this.onTrigger):(t.removeEventListener("click",this.onTrigger),t.removeEventListener("keydown",this.onKeyPress))})}update(){setTimeout(()=>{this.items=this.container.querySelectorAll(".eh-content-accordion-item"),this.itemsInner=this.container.querySelectorAll(".eh-content-accordion-item__inner"),this.getItemsChildrens(),this.items.forEach((t,e)=>{this.isTouchDevice?t.addEventListener("touchstart",this.onTrigger):(t.addEventListener("click",this.onTrigger),t.addEventListener("keydown",this.onKeyPress))})},500)}destroy(){this.removeEvents()}}return a});
